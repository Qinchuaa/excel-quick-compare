# Excel数据对比工具

这是一个使用Python的pandas库和tkinter GUI框架开发的Excel数据对比工具，可以帮助您快速对比两个Excel文件中的数据，找出相同元素、独有元素等。

## 功能特性

- 📊 支持Excel (.xlsx, .xls) 和CSV文件格式
- 🔍 多种对比模式：相同元素、文件1独有、文件2独有、所有差异
- 📋 直观的图形用户界面
- 📤 结果导出功能（Excel/CSV格式）
- 🎯 支持按指定列进行对比
- 📈 实时显示文件信息和对比结果

## 安装要求

确保您的系统已安装Python 3.6或更高版本。

### 安装依赖包

```bash
pip install -r requirements.txt
```

或者手动安装：

```bash
pip install pandas openpyxl xlrd
```

## 使用方法

### 1. 启动程序

```bash
python excel_compare_tool.py
```

### 2. 操作步骤

1. **选择文件**：
   - 点击"浏览"按钮选择要对比的两个Excel文件
   - 支持.xlsx、.xls和.csv格式

2. **加载文件**：
   - 点击"加载文件"按钮读取文件内容
   - 程序会自动识别两个文件的共同列

3. **设置对比参数**：
   - 选择要对比的列（从共同列中选择）
   - 选择对比类型：
     - **相同元素**：显示两个文件中都存在的元素
     - **文件1独有**：显示只在文件1中存在的元素
     - **文件2独有**：显示只在文件2中存在的元素
     - **所有差异**：显示完整的对比结果

4. **开始对比**：
   - 点击"开始对比"按钮执行对比操作
   - 结果会显示在下方的文本区域

5. **导出结果**（可选）：
   - 点击"导出结果"按钮将对比结果保存为Excel或CSV文件

6. **清空结果**（可选）：
   - 点击"清空结果"按钮清除显示的结果

## 使用示例

假设您有两个包含员工信息的Excel文件：

**文件1 (employees_2023.xlsx)**：
| 姓名 | 工号 | 部门 |
|------|------|------|
| 张三 | E001 | 技术部 |
| 李四 | E002 | 销售部 |
| 王五 | E003 | 人事部 |

**文件2 (employees_2024.xlsx)**：
| 姓名 | 工号 | 部门 |
|------|------|------|
| 张三 | E001 | 技术部 |
| 赵六 | E004 | 财务部 |
| 王五 | E003 | 人事部 |

选择"姓名"列进行对比：
- **相同元素**：张三、王五
- **文件1独有**：李四
- **文件2独有**：赵六

## 注意事项

1. **文件格式**：确保Excel文件格式正确，建议使用.xlsx格式
2. **编码问题**：CSV文件建议使用UTF-8编码
3. **数据类型**：程序会将所有数据转换为字符串进行对比
4. **空值处理**：空值（NaN）会被自动忽略
5. **内存使用**：对于大型文件，请确保有足够的内存

## 故障排除

### 常见问题

1. **"文件加载失败"**：
   - 检查文件路径是否正确
   - 确认文件没有被其他程序占用
   - 验证文件格式是否支持

2. **"没有共同列"**：
   - 检查两个文件的列名是否一致
   - 注意列名的大小写和空格

3. **程序运行缓慢**：
   - 可能是文件过大，请耐心等待
   - 考虑分批处理大型数据集

## 技术实现

- **GUI框架**：tkinter（Python标准库）
- **数据处理**：pandas
- **文件读取**：openpyxl（Excel）、xlrd（旧版Excel）
- **数据结构**：使用Python的set进行高效的集合运算

## 许可证

本项目采用MIT许可证，详情请参阅LICENSE文件。

## 贡献

欢迎提交问题报告和功能请求！如果您想贡献代码，请fork本仓库并提交pull request。